 CREATE TABLE PUBLISHER(
  NAME VARCHAR(20) PRIMARY KEY,
  ADDRESS VARCHAR(20),
  PHONE NUMBER(10)
 );

 INSERT INTO PUBLISHER
 VALUES('PEARSON','BANGALORE',9866599);

 INSERT INTO PUBLISHER
 VALUES('TATA MC','BANGALORE',98662289);

INSERT INTO PUBLISHER
VALUES('LAKSHMI','BANGALORE',99234545);

 INSERT INTO PUBLISHER
 VALUES('ROOPAND CO','INDIA',9752333);
 
 INSERT INTO PUBLISHER
 VALUES('AVISHKAR','INDIA',99912112);

 SELECT * FROM PUBLISHER;


 CREATE TABLE BOOK(
  BOOKID INT PRIMARY KEY,
  TITLE VARCHAR2(40),
  PUBLISHER VARCHAR2(40) REFERENCES PUBLISHER ON DELETE CASCADE,
  PUB_YEAR INT
 );

 INSERT INTO BOOK
 VALUES(1,'FUNDAMENTALS OF DATA','PEARSON',2017);

 INSERT INTO BOOK
 VALUES(2,'VINGS OF FIRE','PEARSON',2000);

INSERT INTO BOOK
VALUES(3,'BRINDA','LAKSHMI',2009);

 INSERT INTO BOOK
 VALUES(4,'ENGINEERING MATHS','PEARSON',2017);

 INSERT INTO BOOK
 VALUES(5,'HALF GIRLFRIEND','ROOPAND CO',2014);

SELECT * FROM BOOK;

 CREATE TABLE LIBRARY_BRANCH(
  BRANCH_ID INT PRIMARY KEY,
  BRANCH_NAME VARCHAR2(20),
  ADDRESS VARCHAR2(20)
 );

INSERT INTO LIBRARY_BRANCH
VALUES(1,'CSE','MANGALORE');

 INSERT INTO LIBRARY_BRANCH
 VALUES(2,'MG ROAD','MANGALORE');

INSERT INTO LIBRARY_BRANCH
VALUES(3,'MG ROAD','BANGALORE');

 INSERT INTO LIBRARY_BRANCH
 VALUES(4,'MG ROAD','CHENNAI');

INSERT INTO LIBRARY_BRANCH
VALUES(5,'KS RAO ROAD','CHENNAI');

 SELECT * FROM LIBRARY_BRANCH;


 CREATE TABLE BOOK_COPIES(
  BOOK_ID NUMBER(2) REFERENCES BOOK ON DELETE CASCADE,
  BRANCH_ID NUMBER(2) REFERENCES LIBRARY_BRANCH ON DELETE CASCADE,
  NO_OF_COPIES NUMBER(2),
  PRIMARY KEY(BOOK_ID,BRANCH_ID)
 );

 INSERT INTO BOOK_COPIES
 VALUES(1,1 ,99);

 INSERT INTO BOOK_COPIES
 VALUES(2,1 ,99);

 INSERT INTO BOOK_COPIES
 VALUES(3,2 ,10);

INSERT INTO BOOK_COPIES
VALUES(3,1,9);

 SELECT * FROM BOOK_COPIES;


 CREATE TABLE BOOK_LENDING(
  BOOK_ID NUMBER(5),
  BRANCH_ID NUMBER(3),
  CARD_NO NUMBER(3),
  DATE_OUT DATE,
  DUE_DATE DATE,
  FOREIGN KEY(BOOK_ID,BRANCH_ID) REFERENCES BOOK_COPIES ON DELETE CASCADE,
  PRIMARY KEY(BRANCH_ID,BOOK_ID,CARD_NO),
  CONSTRAINT CK1 CHECK(DUE_DATE>DATE_OUT)
 );

 INSERT INTO BOOK_LENDING
 VALUES(1,1,1,'02-JAN-17','09-JAN-17');

INSERT INTO BOOK_LENDING
VALUES(1,1,2,'02-MAR-17','09-MAR-17');

 INSERT INTO BOOK_LENDING
 VALUES(2,1,2,'02-MAR-17','09-MAR-17');

INSERT INTO BOOK_LENDING
VALUES(3,1,1,'03-FEB-17','09-MAR-17');



CREATE TABLE BOOK_AUTHORS(
  BOOK_ID INT REFERENCES BOOK ON DELETE CASCADE,
  AUTHOR_NAME VARCHAR2(20),
  PRIMARY KEY(BOOK_ID,AUTHOR_NAME)
  
 );

 INSERT INTO BOOK_AUTHORS
 VALUES(1,'ADITYA');

INSERT INTO BOOK_AUTHORS
 VALUES(1,'CHINTHAN');

 INSERT INTO BOOK_AUTHORS
 VALUES(2,'KEERTHAN');

 INSERT INTO BOOK_AUTHORS
 VALUES(3,'VIKAS');

 INSERT INTO BOOK_AUTHORS
 VALUES(5,'VAISHAK');

 SELECT * FROM BOOK_AUTHORS;

Q1:

SELECT B.BOOKID,B.TITLE,B.PUBLISHER,A.AUTHOR_NAME,L.BRANCH_NAME,C.NO_OF_COPIES
FROM BOOK B,BOOK_AUTHORS A,BOOK_COPIES C,LIBRARY_BRANCH L
WHERE B.BOOKID = A.BOOK_ID 
      AND A.BOOK_ID = C.BOOK_ID 
      AND C.BRANCH_ID = L.BRANCH_ID ;

Q2:

SELECT CARD_NO AS CARD_NUM
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-17' AND '30-JUN-17'
GROUP BY CARD_NO
HAVING COUNT(BOOK_ID)>3;

Q3:

DELETE 
FROM BOOK
WHERE BOOKID=2;

Q4 :
CREATE TABLE BOOKP
(
	BOOK_ID INT NOT NULL,
	TITLE VARCHAR(20),
	PUBLISHER_NAME VARCHAR(20),
	PUB_YEAR INT
)
PARTITION BY RANGE(PUB_YEAR)
(
	PARTITION Q0 VALUES LESS THAN(2002),
	PARTITION Q1 VALUES LESS THAN(2010),
	PARTITION Q2 VALUES LESS THAN(2015)
);




